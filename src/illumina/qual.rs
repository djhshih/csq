pub fn decode_phred33(x: u8) -> u8 {
    if x < 33 {
        0
    } else {
        x - 33
    }
}

pub fn encode_phred33(x: u8) -> u8 {
    if x > 40 {
        40 + 33
    } else {
        x + 33
    }
}

/// Bin quality score.
pub fn bin(x: u8) -> u8 {
    match x {
         2 ...  9 =>  6,
        10 ... 19 => 15,
        20 ... 24 => 22,
        25 ... 29 => 27,
        30 ... 34 => 33,
        35 ... 39 => 37,
        40 ... 50 => 40,
        _         =>  0,
    }
}

/// Pack binned quality score.
pub fn pack(x: u8) -> u8 {
    match x {
         2 ...  5 =>  1,
         6 ...  9 =>  2, 
        10 ... 13 =>  3,
        14 ... 16 =>  4,
        17 ... 19 =>  5,
        20 ... 21 =>  6,
        22 ... 23 =>  7,
        24 ... 25 =>  8,
        26 ... 27 =>  9,
        28 ... 29 =>  10,
        30 ... 31 =>  11,
        32 ... 34 =>  12,
        35 ... 37 =>  13,
        38 ... 39 =>  14,
        40 ... 50 =>  15,
        _         =>  0,
    }
}

/*
/// Pack binned quality score.
pub fn pack(x: u8) -> u8 {
    match x {
         2 ...  9 =>  1,
        10 ... 19 =>  2,
        20 ... 24 =>  3,
        25 ... 29 =>  4,
        30 ... 34 =>  5,
        35 ... 39 =>  6,
        40 ... 50 =>  7,
        _         =>  0,
    }
}
*/

